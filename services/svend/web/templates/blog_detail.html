<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ post.title }} â€” Svend Blog</title>
    <meta name="description" content="{{ post.meta_description|default:post.title }}">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://svend.ai/blog/{{ post.slug }}/">

    <!-- Open Graph -->
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://svend.ai/blog/{{ post.slug }}/">
    <meta property="og:title" content="{{ post.title }}">
    <meta property="og:description" content="{{ post.meta_description|default:post.title }}">
    <meta property="og:image" content="https://svend.ai/static/og-image.png">
    <meta property="og:site_name" content="Svend">
    <meta property="article:published_time" content="{{ post.published_at|date:'c' }}">
    <meta property="article:modified_time" content="{{ post.updated_at|date:'c' }}">

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="{{ post.title }}">
    <meta name="twitter:description" content="{{ post.meta_description|default:post.title }}">

    <!-- Structured Data - Article -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Article",
        "headline": "{{ post.title|escapejs }}",
        "description": "{{ post.meta_description|default:post.title|escapejs }}",
        "url": "https://svend.ai/blog/{{ post.slug }}/",
        "datePublished": "{{ post.published_at|date:'c' }}",
        "dateModified": "{{ post.updated_at|date:'c' }}",
        "author": {
            "@type": "Organization",
            "name": "Svend"
        },
        "publisher": {
            "@type": "Organization",
            "name": "Svend",
            "url": "https://svend.ai",
            "logo": {
                "@type": "ImageObject",
                "url": "https://svend.ai/static/logo.png"
            }
        },
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https://svend.ai/blog/{{ post.slug }}/"
        }
    }
    </script>

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/static/favicon.svg">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        :root {
            --bg-primary: #0a0f0a;
            --bg-secondary: #0d120d;
            --bg-card: #0f150f;
            --accent-primary: #4a9f6e;
            --accent-primary-dim: rgba(74, 159, 110, 0.15);
            --text-primary: #e8efe8;
            --text-secondary: #9aaa9a;
            --text-dim: #7a8f7a;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
        }

        /* Nav */
        .nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 40px;
            max-width: 1200px;
            margin: 0 auto;
        }
        .nav .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.2rem;
            font-weight: 600;
            letter-spacing: 2px;
            color: var(--accent-primary);
            text-decoration: none;
        }
        .nav-links { display: flex; gap: 24px; align-items: center; }
        .nav-links a {
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 0.9rem;
            transition: color 0.2s;
        }
        .nav-links a:hover { color: var(--text-primary); }
        .nav-btn {
            background: var(--accent-primary) !important;
            color: var(--bg-primary) !important;
            padding: 8px 20px;
            border-radius: 6px;
            font-weight: 600;
        }

        /* Article */
        .article-header {
            max-width: 720px;
            margin: 60px auto 40px;
            padding: 0 20px;
        }
        .article-header .breadcrumb {
            font-size: 0.8rem;
            color: var(--text-dim);
            margin-bottom: 16px;
        }
        .article-header .breadcrumb a {
            color: var(--accent-primary);
            text-decoration: none;
        }
        .article-header h1 {
            font-size: 2.2rem;
            font-weight: 700;
            line-height: 1.3;
            margin-bottom: 12px;
        }
        .article-header .meta {
            color: var(--text-dim);
            font-size: 0.85rem;
        }

        .article-body {
            max-width: 720px;
            margin: 0 auto;
            padding: 0 20px 80px;
            color: var(--text-secondary);
            font-size: 1.05rem;
            line-height: 1.8;
        }
        .article-body h2 {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--text-primary);
            margin: 2rem 0 0.8rem;
        }
        .article-body h3 {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--text-primary);
            margin: 1.5rem 0 0.6rem;
        }
        .article-body p { margin-bottom: 1rem; }
        .article-body ul, .article-body ol {
            margin: 0.5rem 0 1rem 1.5rem;
        }
        .article-body li { margin-bottom: 0.4rem; }
        .article-body a {
            color: var(--accent-primary);
            text-decoration: none;
            border-bottom: 1px solid rgba(74, 159, 110, 0.3);
        }
        .article-body a:hover { border-bottom-color: var(--accent-primary); }
        .article-body code {
            font-family: 'JetBrains Mono', monospace;
            background: var(--bg-secondary);
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.9em;
        }
        .article-body pre {
            background: var(--bg-secondary);
            padding: 16px 20px;
            border-radius: 6px;
            overflow-x: auto;
            margin: 1rem 0;
        }
        .article-body pre code {
            background: none;
            padding: 0;
        }
        .article-body blockquote {
            border-left: 3px solid var(--accent-primary);
            padding-left: 16px;
            margin: 1rem 0;
            color: var(--text-dim);
            font-style: italic;
        }
        .article-body img {
            max-width: 100%;
            border-radius: 6px;
            margin: 1rem 0;
        }
        .article-body strong { color: var(--text-primary); }

        /* CTA */
        .article-cta {
            max-width: 720px;
            margin: 0 auto 60px;
            padding: 0 20px;
        }
        .article-cta .cta-box {
            background: var(--bg-card);
            border: 1px solid rgba(74, 159, 110, 0.2);
            border-radius: 8px;
            padding: 28px 32px;
            text-align: center;
        }
        .article-cta h3 {
            font-size: 1.1rem;
            margin-bottom: 8px;
        }
        .article-cta p {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-bottom: 16px;
        }
        .article-cta a {
            display: inline-block;
            background: var(--accent-primary);
            color: var(--bg-primary);
            padding: 10px 24px;
            border-radius: 6px;
            font-weight: 600;
            text-decoration: none;
            font-size: 0.9rem;
        }

        /* Footer */
        .blog-footer {
            text-align: center;
            padding: 40px 20px;
            border-top: 1px solid rgba(74, 159, 110, 0.1);
            color: var(--text-dim);
            font-size: 0.8rem;
        }
        .blog-footer a { color: var(--accent-primary); text-decoration: none; }

        @media (max-width: 768px) {
            .nav { padding: 16px 20px; }
            .article-header { margin-top: 40px; }
            .article-header h1 { font-size: 1.6rem; }
            .article-body { font-size: 1rem; }
        }
    </style>
</head>
<body>
    <nav class="nav">
        <a href="/" class="logo">SVEND</a>
        <div class="nav-links">
            <a href="/">Home</a>
            <a href="/blog/">Blog</a>
            <a href="/login/">Login</a>
            <a href="/register/" class="nav-btn">Get Started</a>
        </div>
    </nav>

    <article>
        <header class="article-header">
            <div class="breadcrumb"><a href="/blog/">Blog</a> &rsaquo; {{ post.title }}</div>
            <h1>{{ post.title }}</h1>
            <div class="meta">{{ post.published_at|date:"F j, Y" }}</div>
        </header>

        <div class="article-body" id="article-body">
            {{ post.body }}
        </div>
    </article>

    <div class="article-cta">
        <div class="cta-box">
            <h3>Try Svend Free</h3>
            <p>Professional statistical analysis at 96% less than Minitab. SPC, DOE, capability studies, and more.</p>
            <a href="/register/">Get Started</a>
        </div>
    </div>

    <footer class="blog-footer">
        <a href="/">Svend</a> &middot; Statistical Analysis & Decision Science &middot; <a href="/privacy/">Privacy</a> &middot; <a href="/terms/">Terms</a>
    </footer>

    <!-- Render markdown + charts -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <script>
    (function() {
        const body = document.getElementById('article-body');
        if (!body || typeof marked === 'undefined') return;

        // Custom renderer: ```chart blocks become Chart.js canvases
        const renderer = new marked.Renderer();
        let chartIdx = 0;
        const chartConfigs = [];

        const origCode = renderer.code.bind(renderer);
        renderer.code = function({ text, lang }) {
            if (lang === 'chart') {
                try {
                    const config = JSON.parse(text);
                    const id = 'blog-chart-' + chartIdx++;
                    chartConfigs.push({ id, config });
                    const caption = config.caption ? '<div style="text-align:center;font-size:0.8rem;color:var(--text-dim);margin-top:8px;">' + config.caption + '</div>' : '';
                    return '<div style="max-width:600px;margin:1.5rem auto;"><canvas id="' + id + '"></canvas>' + caption + '</div>';
                } catch(e) {
                    return '<pre><code>' + text + '</code></pre>';
                }
            }
            return origCode({ text, lang });
        };

        marked.setOptions({ renderer });
        body.innerHTML = marked.parse(body.textContent.trim());

        // Render charts after DOM update
        const colors = ['#4a9f6e','#3a7f8f','#e8c547','#c75a3a','#7a5fb8','#5a9fd4','#d4a05a','#5ad4a0'];
        const colorsAlpha = colors.map(c => c + '30');

        chartConfigs.forEach(({ id, config }) => {
            const el = document.getElementById(id);
            if (!el) return;

            // Apply theme defaults
            const cfg = { ...config };
            delete cfg.caption;

            if (cfg.data && cfg.data.datasets) {
                cfg.data.datasets.forEach((ds, i) => {
                    if (!ds.borderColor) ds.borderColor = colors[i % colors.length];
                    if (!ds.backgroundColor) {
                        ds.backgroundColor = (cfg.type === 'line' || cfg.type === 'radar')
                            ? colorsAlpha[i % colors.length]
                            : colors.slice(0, (ds.data || []).length);
                    }
                });
            }

            cfg.options = cfg.options || {};
            cfg.options.responsive = true;
            cfg.options.plugins = cfg.options.plugins || {};
            cfg.options.plugins.legend = cfg.options.plugins.legend || {};
            cfg.options.scales = cfg.options.scales || {};

            // Dark theme
            Chart.defaults.color = '#7a8f7a';
            Chart.defaults.borderColor = 'rgba(74,159,110,0.15)';

            new Chart(el, cfg);
        });
    })();
    </script>
</body>
</html>
